<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validated Side Effects - Birth Control Research</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/style.css">

    <!-- Shared Styles & Components -->
    <link rel="stylesheet" href="/shared/styles/eject-button.css">
    <script src="/shared/components/EjectButton.js"></script>
</head>
<body>
    <!-- Navigation - Eject Button -->
    <eject-button></eject-button>

    <!-- Header -->
    <header class="site-header">
        <div class="page-container" style="max-width: 72rem;">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="site-title">
                        Validated Side Effects
                    </h1>
                    <p class="site-subtitle">
                        Evidence-based classification with PubMed research validation
                    </p>
                </div>
                <a href="index.html" class="btn-secondary" style="text-decoration: none;">
                    ‚Üê Back to Home
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="page-container" style="max-width: 72rem; padding-top: 2rem; padding-bottom: 2rem;">
        <!-- Context Section -->
        <div class="content-card">
            <h2 class="card-title">About This Analysis</h2>
            <p class="card-text">
                This tool analyzes <strong>537 Reddit posts</strong> from birth control communities to identify side effects frequently reported by patients. Of these posts, <strong>386 contained symptom discussions</strong>.
            </p>
            <p class="card-text">
                Each side effect is validated against medical research by cross-referencing with the <strong>PubMed database</strong> and classified into evidence tiers based on FDA listings, research coverage, and patient report frequency.
            </p>
            <p class="card-text">
                Side effects are ranked by a <strong>"surprise score"</strong> that highlights symptoms with high patient discussion frequency but relatively lower research coverage.
            </p>
        </div>


        <!-- Legend -->
        <section class="content-card">
            <h2 class="card-title" style="font-size: 1.25rem;">Evidence Tier Legend</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="flex items-start">
                    <span class="text-2xl mr-3">üèÜ</span>
                    <div>
                        <div class="font-semibold text-gray-900">Tier 1: FDA-Listed</div>
                        <p class="text-sm text-gray-600">Officially listed by FDA</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-2xl mr-3">‚úÖ</span>
                    <div>
                        <div class="font-semibold text-gray-900">Tier 2: Research-Backed</div>
                        <p class="text-sm text-gray-600">3+ PubMed papers found</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-2xl mr-3">üí¨</span>
                    <div>
                        <div class="font-semibold text-gray-900">Tier 3: Patient-Validated</div>
                        <p class="text-sm text-gray-600">50+ patient mentions, <3 papers</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-2xl mr-3">‚ö†Ô∏è</span>
                    <div>
                        <div class="font-semibold text-gray-900">Tier 4: Emerging Pattern</div>
                        <p class="text-sm text-gray-600">Needs more research</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Hidden Side Effects -->
        <section class="content-card" style="background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3);">
            <h2 class="card-title">üéØ Hidden Side Effects</h2>
            <p class="card-text">
                Side effects with high patient reports but lower research coverage
            </p>
            <div id="high-surprise-list" class="space-y-3">
                <div class="text-center py-4 text-gray-500">Loading...</div>
            </div>
        </section>

        <!-- Filter Controls -->
        <section class="content-card">
            <h2 class="card-title" style="font-size: 1.25rem;">Filter by Surprise Level</h2>
            <div class="flex flex-wrap gap-3">
                <button onclick="filterSurprise('all')" class="btn-primary filter-btn active">
                    All Symptoms
                </button>
                <button onclick="filterSurprise('very')" class="btn-secondary filter-btn">
                    üî• Very Surprising
                </button>
                <button onclick="filterSurprise('somewhat')" class="btn-secondary filter-btn">
                    ‚ö†Ô∏è Somewhat Surprising
                </button>
                <button onclick="filterSurprise('expected')" class="btn-secondary filter-btn">
                    ‚úì Expected
                </button>
            </div>
        </section>

        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg shadow mb-8">
            <button
                onclick="toggleSurpriseScore()"
                class="w-full text-left p-6 flex items-center justify-between hover:bg-opacity-80 transition-all"
                aria-expanded="false"
                aria-controls="surprise-score-content"
            >
                <h2 class="text-xl font-bold text-gray-900">üìä What Does "Surprise Score" Mean?</h2>
                <svg id="surprise-score-chevron" class="w-6 h-6 text-gray-700 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>
            <div id="surprise-score-content" class="hidden px-6 pb-6">
                <p class="text-gray-700 mb-3">
                    Each side effect has a <strong>surprise score</strong> that measures the gap between patient reports and research coverage. This helps identify symptoms that deserve more medical attention.
                </p>
                <div class="bg-white rounded-lg p-4 mb-3">
                    <p class="text-gray-800 font-mono text-sm mb-2">
                        <strong>Formula:</strong> surprise_score = patient_frequency √ó (1 - research_coverage)
                    </p>
                    <p class="text-gray-600 text-sm">
                        where research_coverage = min(paper_count / 10, 1.0)
                    </p>
                </div>
                <p class="text-gray-700 mb-3">
                    <strong>Why can research-backed symptoms be "Very Surprising"?</strong>
                </p>
                <p class="text-gray-700 mb-3">
                    A symptom can have research papers but still be surprising if patient reports greatly outnumber the research. For example:
                </p>
                <ul class="list-disc list-inside space-y-2 text-gray-700 mb-3">
                    <li><strong>Anxiety:</strong> 9 research papers found, but appears in 14.7% of patient posts (86 mentions) - suggesting the research may not fully capture how prevalent this experience is</li>
                    <li><strong>PMDD Symptoms:</strong> 4 papers = only 40% research coverage (we'd want 10+ for full coverage), combined with 3.2% patient frequency creates a research gap</li>
                </ul>
                <p class="text-gray-700">
                    <strong>Classification levels:</strong> üî• Very Surprising (‚â•0.015), ‚ö†Ô∏è Somewhat Surprising (‚â•0.008), ‚úì Expected (&lt;0.008)
                </p>
            </div>
        </div>

        <script>
        function toggleSurpriseScore() {
            const content = document.getElementById('surprise-score-content');
            const chevron = document.getElementById('surprise-score-chevron');
            const button = content.previousElementSibling;

            const isHidden = content.classList.contains('hidden');

            if (isHidden) {
                content.classList.remove('hidden');
                chevron.style.transform = 'rotate(180deg)';
                button.setAttribute('aria-expanded', 'true');
            } else {
                content.classList.add('hidden');
                chevron.style.transform = 'rotate(0deg)';
                button.setAttribute('aria-expanded', 'false');
            }
        }
        </script>

        <!-- Validated Side Effects List -->
        <section class="content-card">
            <h2 class="card-title">All Validated Side Effects</h2>
            <div id="validated-side-effects-list" class="side-effects-list">
                <div class="text-center py-8 text-gray-500">Loading validated side effects...</div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12">
        <div class="max-w-6xl mx-auto px-4 py-8">
            <!-- Medical Disclaimer -->
            <div class="bg-yellow-900 bg-opacity-30 border border-yellow-600 rounded-lg p-4 mb-6 max-w-4xl mx-auto">
                <h3 class="text-yellow-300 font-bold text-sm mb-2">‚ö†Ô∏è Important Medical Disclaimer</h3>
                <p class="text-gray-300 text-sm leading-relaxed">
                    This analysis is for <strong>informational and research purposes only</strong> and is <strong>not medical advice</strong>.
                    The data is based on self-reported experiences from Reddit posts and may not reflect clinical research findings or individual medical situations.
                    Always consult a qualified healthcare provider about birth control side effects, medication changes, or any health concerns.
                    If you experience serious side effects, seek immediate medical attention.
                </p>
            </div>
        </div>
    </footer>

    <script src="js/validation.js"></script>
</body>
</html>
