<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Control Side Effects Pattern Explorer</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="css/style.css">

    <!-- Shared Styles & Components -->
    <link rel="stylesheet" href="/shared/styles/eject-button.css">
    <script src="/shared/components/EjectButton.js"></script>
</head>
<body class="bg-gray-50">
    <!-- Navigation - Eject Button -->
    <eject-button></eject-button>

    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-4xl mx-auto px-4 py-12">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900">
                Birth Control Side Effects Pattern Explorer
            </h1>
            <p class="text-gray-600 mt-2">
                Commonly unreported side effects from patient discussions analyzed against medical research
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8">
        <!-- Hero Section -->
        <section class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-lg p-8 text-white mb-8">
            <h2 class="text-3xl md:text-4xl font-bold mb-4">
                Commonly Unreported Birth Control Side Effects
            </h2>
            <p class="text-lg mb-6 text-indigo-100">
                Analysis of 537 patient discussions from Reddit compared with medical research to identify frequently reported side effects.
            </p>
            <div class="flex flex-wrap gap-4">
                <a href="validation.html"
                   class="inline-block bg-white text-indigo-600 font-semibold px-6 py-3 rounded-lg shadow hover:bg-indigo-50 transition">
                    üìä View Validated Side Effects
                </a>
                <a href="long-term.html"
                   class="inline-block bg-white text-indigo-600 font-semibold px-6 py-3 rounded-lg shadow hover:bg-indigo-50 transition">
                    ‚è±Ô∏è Long-Term Effects (5+ Years)
                </a>
            </div>
        </section>

        <!-- Context Section -->
        <section class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">About This Analysis</h2>
            <p class="text-gray-700 mb-3">
                Birth control (hormonal contraception) is used by millions of people worldwide. While official documentation lists common side effects, patient experiences often include additional symptoms that may not be widely documented in medical literature.
            </p>
            <p class="text-gray-700 mb-3">
                This tool analyzes 537 Reddit posts from birth control communities to identify frequently reported side effects and compares them with medical research literature (PubMed database).
            </p>
        </section>

        <!-- Stats Cards -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="text-3xl font-bold text-indigo-600" id="stat-posts">537</div>
                <div class="text-gray-600 mt-1">Posts Analyzed</div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <div class="text-3xl font-bold text-purple-600" id="stat-symptoms">386</div>
                <div class="text-gray-600 mt-1">Posts with Symptoms</div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <div class="text-3xl font-bold text-pink-600" id="stat-patterns">17</div>
                <div class="text-gray-600 mt-1">Patterns Found</div>
            </div>
        </section>

        <!-- Top Symptoms -->
        <section class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Most Common Side Effects</h2>
            <div id="top-symptoms-list" class="space-y-3">
                <!-- Dynamically populated -->
            </div>
        </section>

        <!-- Network Visualization -->
        <section class="bg-white rounded-lg shadow p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Symptom Network Graph</h2>
                    <p class="text-gray-600">Explore relationships between symptoms</p>
                </div>
                <div class="flex gap-2">
                    <button
                        id="toggle-filters-btn"
                        class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-4 py-2 rounded-lg transition"
                    >
                        ‚öôÔ∏è Filters
                    </button>
                    <button
                        id="reset-btn"
                        class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium px-4 py-2 rounded-lg transition"
                    >
                        Reset View
                    </button>
                </div>
            </div>

            <!-- Instructions -->
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded">
                <h3 class="text-sm font-semibold text-blue-900 mb-2">How to use</h3>
                <ul class="text-blue-800 text-sm space-y-1">
                    <li>‚Ä¢ <strong>Node size</strong> = How frequently the symptom appears</li>
                    <li>‚Ä¢ <strong>Line thickness</strong> = Strength of the relationship</li>
                    <li>‚Ä¢ <strong>Click a node</strong> to highlight its connections</li>
                    <li>‚Ä¢ <strong>Drag nodes</strong> to rearrange the layout</li>
                </ul>
            </div>

            <!-- Search & Filters (Collapsible) -->
            <div id="controls-panel" class="mb-4 p-4 bg-gray-50 rounded-lg space-y-4 hidden">
                <!-- Search Box -->
                <div>
                    <label for="symptom-search" class="block text-sm font-medium text-gray-700 mb-2">
                        üîç Search for symptom
                    </label>
                    <input
                        type="text"
                        id="symptom-search"
                        placeholder="Type to find a symptom (e.g., anxiety, acne)..."
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                </div>

                <!-- Filters Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Symptom Type Filter -->
                    <div>
                        <label for="type-filter" class="block text-sm font-medium text-gray-700 mb-2">
                            Category
                        </label>
                        <select
                            id="type-filter"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        >
                            <option value="all">All Symptoms</option>
                            <option value="mental">Mental Only</option>
                            <option value="physical">Physical Only</option>
                        </select>
                    </div>

                    <!-- Confidence Filter -->
                    <div>
                        <label for="confidence-slider" class="block text-sm font-medium text-gray-700 mb-2">
                            Min Confidence: <span id="confidence-value">0%</span>
                        </label>
                        <input
                            type="range"
                            id="confidence-slider"
                            min="0"
                            max="100"
                            value="0"
                            class="w-full"
                        />
                    </div>

                    <!-- Lift Filter -->
                    <div>
                        <label for="lift-slider" class="block text-sm font-medium text-gray-700 mb-2">
                            Min Lift: <span id="lift-value">1.0x</span>
                        </label>
                        <input
                            type="range"
                            id="lift-slider"
                            min="10"
                            max="30"
                            value="10"
                            step="1"
                            class="w-full"
                        />
                    </div>
                </div>

                <!-- Stats Display -->
                <div class="flex justify-between items-center text-sm text-gray-600 pt-2 border-t border-gray-200">
                    <span id="visible-stats">Showing all symptoms and connections</span>
                    <button
                        id="clear-filters-btn"
                        class="text-blue-600 hover:text-blue-800 font-medium"
                    >
                        Clear Filters
                    </button>
                </div>
            </div>

            <div id="network-container" style="width: 100%; height: 600px; border: 2px solid var(--gb-darkest); border-radius: 2px; background: var(--bg); box-shadow: var(--shadow-md); position: relative;"></div>

            <!-- Legend -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                <h3 class="font-semibold text-gray-900 mb-3">Legend</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
                    <div class="flex items-center">
                        <svg width="30" height="20" class="mr-2">
                            <circle cx="15" cy="10" r="8" fill="#E4ACB2" stroke="#fff" stroke-width="2"/>
                        </svg>
                        <span class="text-gray-700">Mental symptom</span>
                    </div>
                    <div class="flex items-center">
                        <svg width="30" height="20" class="mr-2">
                            <circle cx="15" cy="10" r="8" fill="#99BAB9" stroke="#fff" stroke-width="2"/>
                        </svg>
                        <span class="text-gray-700">Physical symptom</span>
                    </div>
                    <div class="flex items-center">
                        <svg width="30" height="20" class="mr-2">
                            <line x1="0" y1="10" x2="30" y2="10" stroke="#9ca3af" stroke-width="3"/>
                        </svg>
                        <span class="text-gray-700">Connection strength</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- No Data Message for network -->
        <section id="no-data" class="hidden bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded mb-8">
            <h3 class="text-lg font-semibold text-yellow-900 mb-2">
                No network data available
            </h3>
            <p class="text-yellow-800">
                The pattern mining analysis didn't generate enough data for visualization.
            </p>
        </section>

        <!-- Node Details Panel for network -->
        <section id="details-panel" class="hidden bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
                Symptom Details
            </h2>
            <div id="details-content">
                <!-- Dynamically populated -->
            </div>
        </section>

        <!-- Symptom Checker -->
        <section class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-2">Symptom Checker</h2>
            <p class="text-gray-600 mb-6">Select symptoms you're experiencing to see what other symptoms commonly appear together</p>

            <!-- Search Box -->
            <div class="mb-6">
                <label for="symptom-search-checker" class="block text-sm font-medium text-gray-700 mb-2">
                    üîç Search symptoms
                </label>
                <input
                    type="text"
                    id="symptom-search-checker"
                    placeholder="Type to search (e.g., anxiety, acne)..."
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                />
            </div>

            <!-- Selected Symptoms -->
            <div class="mb-6">
                <h3 class="text-sm font-medium text-gray-700 mb-2">
                    Selected (<span id="selected-count">0</span>):
                </h3>
                <div id="selected-symptoms" class="min-h-[3rem] p-3 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
                    <p class="text-gray-400 text-sm" id="empty-state">
                        Select symptoms from the list below
                    </p>
                </div>
            </div>

            <!-- Popular Symptoms -->
            <div class="mb-6">
                <h3 class="text-sm font-medium text-gray-700 mb-3">
                    Popular Symptoms:
                </h3>
                <div id="popular-symptoms" class="flex flex-wrap gap-2">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- All Symptoms -->
            <div class="mb-6">
                <h3 class="text-sm font-medium text-gray-700 mb-3">
                    All Symptoms:
                </h3>
                <div id="all-symptoms" class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-96 overflow-y-auto p-2 border border-gray-200 rounded-lg">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Analyze Button -->
            <button
                id="analyze-btn"
                disabled
                class="w-full bg-blue-600 text-white font-semibold px-6 py-3 rounded-lg shadow hover:bg-blue-700 transition disabled:bg-gray-300 disabled:cursor-not-allowed"
            >
                Analyze Patterns
            </button>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="hidden bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
                Discovered Patterns
            </h2>
            <div id="results-content">
                <!-- Dynamically populated -->
            </div>
        </section>

        <!-- No Results Message -->
        <section id="no-results" class="hidden bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded mb-8">
            <h3 class="text-lg font-semibold text-yellow-900 mb-2">
                No patterns found
            </h3>
            <p class="text-yellow-800">
                We didn't find any significant patterns for the selected symptoms. This could mean the combination is rare or these symptoms appear independently.
            </p>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <!-- Medical Disclaimer -->
            <div class="bg-yellow-900 bg-opacity-30 border border-yellow-600 rounded-lg p-4 mb-6">
                <h3 class="text-yellow-300 font-bold text-sm mb-2">‚ö†Ô∏è Important Medical Disclaimer</h3>
                <p class="text-gray-300 text-sm leading-relaxed">
                    This analysis is for <strong>informational and research purposes only</strong> and is <strong>not medical advice</strong>.
                    The data is based on self-reported experiences from Reddit posts and may not reflect clinical research findings or individual medical situations.
                    Always consult a qualified healthcare provider about birth control side effects, medication changes, or any health concerns.
                    If you experience serious side effects, seek immediate medical attention.
                </p>
            </div>

            <div class="text-center">
                <p class="text-gray-400 text-sm">
                    All Reddit data was anonymized during collection. No personally identifiable information is stored.
                </p>
            </div>
        </div>
    </footer>

    <!-- Tooltip for network graph -->
    <div id="tooltip" style="position: absolute; padding: 0.5rem; background: var(--bg); color: var(--text-primary); border: 2px solid var(--gb-darkest); border-radius: 2px; box-shadow: var(--shadow-md); pointer-events: none; font-family: 'Courier New', monospace; font-size: 0.75rem; z-index: 100; display: none;"></div>

    <script src="js/app.js"></script>
    <script src="js/network.js"></script>
    <script src="js/symptom-checker.js"></script>
</body>
</html>
